named_mapping_example:
  dag_id: named_mapping_example
  params: {}
  default_args:
    start_date: '2026-01-01'
  schedule: 0 0 * * ? *
  tasks:
    generate_data:
      operator: airflow.providers.standard.operators.python.PythonOperator
      op_args: []
      op_kwargs: {}
      outlets: []
      params: {}
      priority_weight: 1
      python_callable: dtm_named_mapping.generate_data
      retries: 0
      retry_delay: 300.0
      retry_exponential_backoff: false
      task_id: generate_data
      trigger_rule: all_success
      wait_for_downstream: false
      dependencies: []
    process_city:
      operator: airflow.providers.standard.operators.python.PythonOperator
      outlets: []
      params: {}
      priority_weight: 1
      retries: 0
      retry_delay: 300.0
      retry_exponential_backoff: false
      task_id: process_city
      trigger_rule: all_success
      wait_for_downstream: false
      dependencies: [generate_data]
      expand:
        op_args: generate_data.output
      partial:
        map_index_template: '{{ city_name }}'
        weight_rule: downstream
      python_callable: dtm_named_mapping.process_city_data
    summarize:
      operator: airflow.providers.standard.operators.python.PythonOperator
      op_args: []
      op_kwargs:
        results: '{{ task_instance.xcom_pull(task_ids=''process_city'', key=''return_value'')
          }}'
      outlets: []
      params: {}
      priority_weight: 1
      python_callable: dtm_named_mapping.summarize_results
      retries: 0
      retry_delay: 300.0
      retry_exponential_backoff: false
      task_id: summarize
      trigger_rule: all_success
      wait_for_downstream: false
      dependencies: [process_city]
